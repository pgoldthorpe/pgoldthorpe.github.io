<body></body>
<script>
data = [
{x:3.600, y:79},
{x:1.800, y:54},
{x:3.333, y:74},
{x:2.283, y:62},
{x:4.533, y:85},
{x:2.883, y:55},
{x:4.700, y:88},
{x:3.600, y:85},
{x:1.950, y:51},
{x:4.350, y:85},
{x:1.833, y:54},
{x:3.917, y:84},
{x:4.200, y:78},
{x:1.750, y:47},
{x:4.700, y:83},
{x:2.167, y:52},
{x:1.750, y:62},
{x:4.800, y:84},
{x:1.600, y:52},
{x:4.250, y:79},
{x:1.800, y:51},
{x:1.750, y:47},
{x:3.450, y:78},
{x:3.067, y:69},
{x:4.533, y:74},
{x:3.600, y:83},
{x:1.967, y:55},
{x:4.083, y:76},
{x:3.850, y:78},
{x:4.433, y:79},
{x:4.300, y:73},
{x:4.467, y:77},
{x:3.367, y:66},
{x:4.033, y:80},
{x:3.833, y:74},
{x:2.017, y:52},
{x:1.867, y:48},
{x:4.833, y:80},
{x:1.833, y:59},
{x:4.783, y:90},
{x:4.350, y:80},
{x:1.883, y:58},
{x:4.567, y:84},
{x:1.750, y:58},
{x:4.533, y:73},
{x:3.317, y:83},
{x:3.833, y:64},
{x:2.100, y:53},
{x:4.633, y:82},
{x:2.000, y:59},
{x:4.800, y:75},
{x:4.716, y:90},
{x:1.833, y:54},
{x:4.833, y:80},
{x:1.733, y:54},
{x:4.883, y:83},
{x:3.717, y:71},
{x:1.667, y:64},
{x:4.567, y:77},
{x:4.317, y:81},
{x:2.233, y:59},
{x:4.500, y:84},
{x:1.750, y:48},
{x:4.800, y:82},
{x:1.817, y:60},
{x:4.400, y:92},
{x:4.167, y:78},
{x:4.700, y:78},
{x:2.067, y:65},
{x:4.700, y:73},
{x:4.033, y:82},
{x:1.967, y:56},
{x:4.500, y:79},
{x:4.000, y:71},
{x:1.983, y:62},
{x:5.067, y:76},
{x:2.017, y:60},
{x:4.567, y:78},
{x:3.883, y:76},
{x:3.600, y:83},
{x:4.133, y:75},
{x:4.333, y:82},
{x:4.100, y:70},
{x:2.633, y:65},
{x:4.067, y:73},
{x:4.933, y:88},
{x:3.950, y:76},
{x:4.517, y:80},
{x:2.167, y:48},
{x:4.000, y:86},
{x:2.200, y:60},
{x:4.333, y:90},
{x:1.867, y:50},
{x:4.817, y:78},
{x:1.833, y:63},
{x:4.300, y:72},
{x:4.667, y:84},
{x:3.750, y:75},
{x:1.867, y:51},
{x:4.900, y:82},
{x:2.483, y:62},
{x:4.367, y:88},
{x:2.100, y:49},
{x:4.500, y:83},
{x:4.050, y:81},
{x:1.867, y:47},
{x:4.700, y:84},
{x:1.783, y:52},
{x:4.850, y:86},
{x:3.683, y:81},
{x:4.733, y:75},
{x:2.300, y:59},
{x:4.900, y:89},
{x:4.417, y:79},
{x:1.700, y:59},
{x:4.633, y:81},
{x:2.317, y:50},
{x:4.600, y:85},
{x:1.817, y:59},
{x:4.417, y:87},
{x:2.617, y:53},
{x:4.067, y:69},
{x:4.250, y:77},
{x:1.967, y:56},
{x:4.600, y:88},
{x:3.767, y:81},
{x:1.917, y:45},
{x:4.500, y:82},
{x:2.267, y:55},
{x:4.650, y:90},
{x:1.867, y:45},
{x:4.167, y:83},
{x:2.800, y:56},
{x:4.333, y:89},
{x:1.833, y:46},
{x:4.383, y:82},
{x:1.883, y:51},
{x:4.933, y:86},
{x:2.033, y:53},
{x:3.733, y:79},
{x:4.233, y:81},
{x:2.233, y:60},
{x:4.533, y:82},
{x:4.817, y:77},
{x:4.333, y:76},
{x:1.983, y:59},
{x:4.633, y:80},
{x:2.017, y:49},
{x:5.100, y:96},
{x:1.800, y:53},
{x:5.033, y:77},
{x:4.000, y:77},
{x:2.400, y:65},
{x:4.600, y:81},
{x:3.567, y:71},
{x:4.000, y:70},
{x:4.500, y:81},
{x:4.083, y:93},
{x:1.800, y:53},
{x:3.967, y:89},
{x:2.200, y:45},
{x:4.150, y:86},
{x:2.000, y:58},
{x:3.833, y:78},
{x:3.500, y:66},
{x:4.583, y:76},
{x:2.367, y:63},
{x:5.000, y:88},
{x:1.933, y:52},
{x:4.617, y:93},
{x:1.917, y:49},
{x:2.083, y:57},
{x:4.583, y:77},
{x:3.333, y:68},
{x:4.167, y:81},
{x:4.333, y:81},
{x:4.500, y:73},
{x:2.417, y:50},
{x:4.000, y:85},
{x:4.167, y:74},
{x:1.883, y:55},
{x:4.583, y:77},
{x:4.250, y:83},
{x:3.767, y:83},
{x:2.033, y:51},
{x:4.433, y:78},
{x:4.083, y:84},
{x:1.833, y:46},
{x:4.417, y:83},
{x:2.183, y:55},
{x:4.800, y:81},
{x:1.833, y:57},
{x:4.800, y:76},
{x:4.100, y:84},
{x:3.966, y:77},
{x:4.233, y:81},
{x:3.500, y:87},
{x:4.366, y:77},
{x:2.250, y:51},
{x:4.667, y:78},
{x:2.100, y:60},
{x:4.350, y:82},
{x:4.133, y:91},
{x:1.867, y:53},
{x:4.600, y:78},
{x:1.783, y:46},
{x:4.367, y:77},
{x:3.850, y:84},
{x:1.933, y:49},
{x:4.500, y:83},
{x:2.383, y:71},
{x:4.700, y:80},
{x:1.867, y:49},
{x:3.833, y:75},
{x:3.417, y:64},
{x:4.233, y:76},
{x:2.400, y:53},
{x:4.800, y:94},
{x:2.000, y:55},
{x:4.150, y:76},
{x:1.867, y:50},
{x:4.267, y:82},
{x:1.750, y:54},
{x:4.483, y:75},
{x:4.000, y:78},
{x:4.117, y:79},
{x:4.083, y:78},
{x:4.267, y:78},
{x:3.917, y:70},
{x:4.550, y:79},
{x:4.083, y:70},
{x:2.417, y:54},
{x:4.183, y:86},
{x:2.217, y:50},
{x:4.450, y:90},
{x:1.883, y:54},
{x:1.850, y:54},
{x:4.283, y:77},
{x:3.950, y:79},
{x:2.333, y:64},
{x:4.150, y:75},
{x:2.350, y:47},
{x:4.933, y:86},
{x:2.900, y:63},
{x:4.583, y:85},
{x:3.833, y:82},
{x:2.083, y:57},
{x:4.367, y:82},
{x:2.133, y:67},
{x:4.350, y:74},
{x:2.200, y:54},
{x:4.450, y:83},
{x:3.567, y:73},
{x:4.500, y:73},
{x:4.150, y:88},
{x:3.817, y:80},
{x:3.917, y:71},
{x:4.450, y:83},
{x:2.000, y:56},
{x:4.283, y:79},
{x:4.767, y:78},
{x:4.533, y:84},
{x:1.850, y:58},
{x:4.250, y:83},
{x:1.983, y:43},
{x:2.250, y:60},
{x:4.750, y:75},
{x:4.117, y:81},
{x:2.150, y:46},
{x:4.417, y:90},
{x:1.817, y:46},
{x:4.467, y:74},
]

</script>
<script src="https://d3js.org/d3.v5.min.js"></script>
<script>
  var width = 600,
      height = 400,
      margin = ({top: 20, right: 30, bottom: 30, left: 40});
  var svg = d3.select('body').append('svg').attr('viewBox',[0,0,width,height])

  var drag = d3.drag()
  .on('start', dragstarted)
  .on('drag', dragged)
  .on('end', dragended)

function dragstarted(d) {
  d3.select(this).attr("stroke", "black");
}

function dragged(d) {
    d3.select(this).raise()
    .attr("cx", d3.event.x)
    .attr("cy", d3.event.y)
    // updateLine();
  }

function dragended(d) {
  d3.select(this).attr("stroke", null);
}

  x = d3.scaleLinear()
    .domain(d3.extent(data, d => d.x)).nice()
    .rangeRound([margin.left, width - margin.right])

  y = d3.scaleLinear()
    .domain(d3.extent(data, d => d.y)).nice()
    .rangeRound([height - margin.bottom, margin.top])

  //Function assignment
  yAxis = g => g.append("g")
    .attr("transform", `translate(${margin.left},0)`)
    .call(d3.axisLeft(y).tickSizeOuter(0))
    .call(g => g.select(".domain").remove())
    .call(g => g.select(".tick:last-of-type text").clone()
        .attr("x", 3)
        .attr("text-anchor", "start")
        .attr("font-weight", "bold")
        .text(data.y))

  xAxis = g => g.append("g")
    .attr("transform", `translate(0,${height - margin.bottom})`)
    .call(d3.axisBottom(x).tickSizeOuter(0))
    .call(g => g.select(".domain").remove())
    .call(g => g.select(".tick:last-of-type text").clone()
        .attr("y", -3)
        .attr("dy", null)
        .attr("font-weight", "bold")
        .text(data.x))
  svg.append('g').call(xAxis)
  svg.append('g').call(yAxis)



  scratchpad = svg.append('g').attr('fill','none')
  .attr('stroke','steelblue')
  .attr('stroke-linejoin', 'round')
  update(data)

  function update(data) {
    contours = d3.contourDensity()
    .x(d => x(d.x))
    .y(d => y(d.y))
    .size([width, height])
    .bandwidth(30)
    .thresholds(30)
    (data)

    scratchpad.selectAll('path')
      .data(contours)
      .join(
        enter => enter.append('path')
        .attr('d',d3.geoPath()),
        update => update.transition().duration(5000)
        .attr('stroke-width', (d,i) => i%5 ? 0.25:1)
        .attr('d',d3.geoPath()),
        exit => exit.remove()
        );
  }

  svg.append('g').attr('stroke','white')
  .selectAll('circle')
  .data(data)
  .enter().append('circle')
    .attr('cx', d => x(d.x))
    .attr('cy', d => y(d.y))
    .attr('r', 2)
    .call(drag)
    .on('click', clicked);

function clicked(d) {
  d3.event.stopPropagation(); // stop click event for svg if circle click
  if (d3.event.defaultPrevented) return; // dragged
  if (d3.event.ctrlKey) {
    d3.select(this).remove();
    // updateLine();
    return;
    }
  
  return;
  // d3.select(this).transition()
  //     .attr("r", radius * 2)
  //     .attr("fill", 'rgb(100,160,40)')
  //   .transition()
  //     .attr("r", radius);
      
}
</script>